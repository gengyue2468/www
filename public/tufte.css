@charset "UTF-8";

/* Tufte CSS styles */
html {
  font-size: var(--font-base-size);
}

body {
  width: var(--width-body);
  margin-left: auto;
  margin-right: auto;
  padding-left: var(--width-padding-left);
  padding-right: 0;
  font-family: var(--font-serif);
  background-color: var(--bg-color);
  color: var(--text-color);
  max-width: var(--max-width-body);
  counter-reset: sidenote-counter;
  overflow-x: hidden;
}

/* Italic elements */
h2,
h3,
blockquote,
div.epigraph > blockquote,
div.epigraph > blockquote > p,
div.epigraph > blockquote > footer > cite {
  font-style: italic;
}

::selection {
  background: var(--accent);
  color: var(--text-color);
}

/* Adds dark mode */
@media (prefers-color-scheme: dark) {
  :root {
    color-scheme: dark;
  }
  body {
    background-color: var(--bg-color-dark);
    color: var(--text-color-dark);
  }
  ::selection {
    background: var(--accent);
    color: var(--text-color-dark);
  }
}

h1 {
  font-weight: 400;
  margin-top: var(--spacing-h1-top);
  margin-bottom: var(--spacing-h1-bottom);
  font-size: var(--font-size-h1);
  line-height: var(--line-height-base);
}

h2 {
  font-style: italic;
  font-weight: 400;
  margin-top: var(--spacing-h2-top);
  margin-bottom: var(--spacing-h2-bottom);
  font-size: var(--font-size-h2);
  line-height: var(--line-height-base);
}

h3 {
  font-style: italic;
  font-weight: 400;
  font-size: var(--font-size-h3);
  margin-top: var(--spacing-h3-top);
  margin-bottom: var(--spacing-h3-bottom);
  line-height: var(--line-height-base);
}

hr {
  display: block;
  height: 1px;
  width: var(--width-content);
  border: 0;
  border-top: 1px solid var(--border-color);
  margin: 1em 0;
  padding: 0;
}

p.subtitle {
  font-style: italic;
  margin-top: 1rem;
  margin-bottom: 1rem;
  font-size: var(--font-size-subtitle);
  display: block;
  line-height: var(--line-height-base);
}

.numeral {
  font-family: var(--font-numeral);
}

.danger {
  color: var(--danger-color);
}

article {
  padding: var(--spacing-article) 0rem;
}

section {
  padding-top: var(--spacing-section);
  padding-bottom: var(--spacing-section);
}

p,
dl,
ol,
ul {
  font-size: var(--font-size-body);
  line-height: var(--line-height-body);
}

p {
  margin-top: var(--spacing-p-top);
  margin-bottom: var(--spacing-p-bottom);
  padding-right: 0;
  vertical-align: baseline;
}

/* Chapter Epigraphs */
div.epigraph {
  margin: var(--spacing-epigraph) 0;
}

div.epigraph > blockquote {
  margin-top: var(--spacing-epigraph-quote);
  margin-bottom: var(--spacing-epigraph-quote);
}

div.epigraph > blockquote,
div.epigraph > blockquote > p {
  font-style: oblique 6deg;
}

div.epigraph > blockquote > footer {
  font-style: normal;
}

div.epigraph > blockquote > footer > cite {
  font-style: oblique 6deg;
}
/* end chapter epigraphs styles */

blockquote {
  font-size: var(--font-size-body);
}

blockquote p {
  width: var(--width-content);
  margin-right: 40px;
}

blockquote footer {
  width: var(--width-content);
  font-size: var(--font-size-sidenote);
  text-align: right;
}

section > p,
section > footer,
section > table {
  width: var(--width-content);
  overflow-wrap: break-word;
}

/* 50 + 5 == 55, to be the same width as paragraph */
section > dl,
section > ol,
section > ul {
  width: var(--width-list);
  -webkit-padding-start: var(--width-list-padding);
}

dt:not(:first-child),
li:not(:first-child) {
  margin-top: var(--spacing-list-item);
}

figure {
  padding: 0;
  border: 0;
  font-size: 100%;
  font: inherit;
  vertical-align: baseline;
  max-width: var(--width-content);
  -webkit-margin-start: 0;
  -webkit-margin-end: 0;
  margin: 0 0 var(--spacing-figure-bottom) 0;
}

figcaption {
  float: right;
  clear: right;
  margin-top: 0;
  margin-bottom: 0;
  font-size: var(--font-size-sidenote);
  line-height: var(--line-height-caption);
  vertical-align: baseline;
  position: relative;
  max-width: var(--width-figcaption);
}

figure.fullwidth figcaption {
  margin-right: var(--width-figcaption-fullwidth);
}

a:link,
a:visited {
  color: inherit;
  text-underline-offset: var(--text-underline-offset);
  text-decoration-thickness: var(--text-decoration-thickness);
}

/* Sidenotes, margin notes, figures, captions */
img {
  max-width: 100%;
}

.sidenote,
.marginnote {
  float: right;
  clear: right;
  margin-right: var(--width-sidenote-margin);
  width: var(--width-sidenote);
  margin-top: var(--spacing-sidenote-top);
  margin-bottom: 0;
  font-size: var(--font-size-sidenote);
  line-height: var(--line-height-sidenote);
  vertical-align: baseline;
  position: relative;
  display: block;
}

/* Ensure marginnote displays correctly on desktop */
@media (min-width: 761px) {
  section {
    position: relative;
    overflow: visible;
  }

  /* For standalone marginnotes (direct children of section), don't clear */
  /* This allows them to float next to their adjacent content */
  section > label.margin-toggle ~ .marginnote,
  section > label.margin-toggle ~ .sidenote {
    clear: none;
  }
}

.marginnote img {
  max-width: 100%;
  width: 100%;
  height: auto;
  display: block;
  margin-bottom: 0.5rem;
  object-fit: contain;
}

.sidenote img,
.marginnote img {
  max-width: 100%;
  width: 100%;
  height: auto;
  display: block;
  margin-bottom: 0.5rem;
  overflow: hidden;
}

/* Ensure figures inside sidenotes/marginnotes don't float - override default figure/figcaption styles */
.sidenote figure,
.marginnote figure {
  float: none !important;
  clear: none !important;
  width: 100% !important;
  max-width: 100% !important;
  max-width: 100vw !important;
  margin: 0 0 0.5rem 0 !important;
  padding: 0 !important;
  border: 0 !important;
  font-size: 100% !important;
  -webkit-margin-start: 0 !important;
  -webkit-margin-end: 0 !important;
}

.sidenote figure img,
.marginnote figure img {
  margin: 0;
  max-width: 100% !important;
  width: 100% !important;
  height: auto !important;
  display: block !important;
}

.sidenote figcaption,
.marginnote figcaption {
  float: none !important;
  clear: none !important;
  position: static !important;
  width: 100% !important;
  max-width: 100% !important;
  font-size: 1rem !important;
  font: inherit !important;
  vertical-align: baseline !important;
  margin: 0 0 0.5rem 0 !important;
  padding: 0 !important;
  text-align: left !important;
  line-height: 1.6 !important;
}

.sidenote-number {
  counter-increment: sidenote-counter;
}

.sidenote-number:after,
.sidenote:before {
  font-family: var(--font-numeral);
  position: relative;
  vertical-align: baseline;
}

.sidenote-number:after {
  content: counter(sidenote-counter);
  font-size: 1rem;
  top: var(--sidenote-number-top);
  left: var(--sidenote-number-left);
}

.sidenote:before {
  content: counter(sidenote-counter) " ";
  font-size: 1rem;
  top: var(--sidenote-number-top);
}

blockquote .sidenote,
blockquote .marginnote {
  margin-right: var(--width-sidenote-blockquote-margin);
  min-width: var(--width-sidenote-blockquote-min);
  text-align: left;
}

div.fullwidth,
table.fullwidth {
  width: 100%;
}

div.table-wrapper {
  overflow-x: auto;
  font-family: var(--font-sans-alt);
}

.sans {
  font-family: var(--font-sans);
  letter-spacing: var(--letter-spacing-sans);
}

code,
pre > code {
  font-family: var(--font-mono);
  font-size: var(--font-size-code);
  line-height: var(--line-height-code);
  -webkit-text-size-adjust: 100%; /* Prevent adjustments of font size after orientation changes in iOS. See https://github.com/edwardtufte/tufte-css/issues/81#issuecomment-261953409 */
}

.sans > code {
  font-size: var(--font-size-code-sans);
}

h1 > code,
h2 > code,
h3 > code {
  font-size: var(--font-size-code-heading);
}

.marginnote > code,
.sidenote > code {
  font-size: 1rem;
}

pre > code {
  font-size: var(--font-size-code-small);
  width: var(--width-code);
  margin-left: var(--width-code-margin);
  overflow-x: auto;
  display: block;
}

pre.fullwidth > code {
  width: var(--width-fullwidth);
}

.fullwidth {
  max-width: var(--width-fullwidth);
  clear: both;
}

span.newthought {
  font-variant: small-caps;
  font-size: var(--font-size-newthought);
}

input.margin-toggle {
  display: none;
}

label.sidenote-number {
  display: inline-block;
  max-height: 2rem; /* should be less than or equal to paragraph line-height */
}

label.margin-toggle:not(.sidenote-number) {
  display: none;
}

.iframe-wrapper {
  position: relative;
  padding-bottom: var(--iframe-padding-bottom); /* 16:9 */
  padding-top: var(--iframe-padding-top);
  height: 0;
}

.iframe-wrapper iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

@media (max-width: 760px) {
  body {
    width: var(--width-body-mobile);
    padding-left: var(--width-padding-left-mobile);
    padding-right: var(--width-padding-left-mobile);
  }

  hr,
  section > p,
  section > footer,
  section > table {
    width: 100%;
  }

  pre > code {
    width: var(--width-fullwidth-mobile);
  }

  section > dl,
  section > ol,
  section > ul {
    width: var(--width-list-mobile);
  }

  figure {
    max-width: 100%;
    width: 100%;
  }

  figcaption,
  figure.fullwidth figcaption {
    margin-right: 0%;
    max-width: none;
  }

  blockquote {
    margin-left: var(--spacing-blockquote-left);
    margin-right: 0em;
  }

  blockquote p,
  blockquote footer {
    width: 100%;
  }

  label.margin-toggle:not(.sidenote-number) {
    display: inline;
  }

  .sidenote,
  .marginnote {
    display: none;
  }

  .margin-toggle:checked + .sidenote,
  .margin-toggle:checked + .marginnote {
    display: block;
    float: left;
    left: 1rem;
    clear: both;
    width: var(--width-sidenote-mobile);
    margin: 1rem 2.5%;
    vertical-align: baseline;
    position: relative;
  }

  label {
    cursor: pointer;
  }

  div.table-wrapper,
  table {
    width: var(--width-table-mobile);
  }

  img {
    width: 100%;
    max-width: 100%;
    display: block;
    margin-block: 1.4rem;
  }

  figure {
    width: 100%;
    max-width: 100%;
    margin-block: 1.4rem;
  }

  figure img {
    width: 100%;
    max-width: 100%;
  }

  p img {
    width: 100%;
    max-width: 100%;
    margin-block: 1.4rem;
  }
}

/* Fold blocks (details/summary) */
details {
  margin: 1.4rem 0;
  width: var(--width-content);
}

details summary {
  cursor: pointer;
  font-weight: 500;
  font-size: var(--font-size-body);
  line-height: var(--line-height-body);
  padding: 0.5rem 0;
  user-select: none;
  list-style: none;
}

details summary::-webkit-details-marker {
  display: none;
}

details summary::before {
  content: "â–¶ ";
  display: inline-block;
  margin-right: 0.5rem;
  transition: transform 0.2s;
  font-size: 0.8em;
}

details[open] summary::before {
  transform: rotate(90deg);
}

details > *:not(summary) {
  margin-left: 1.5rem;
  margin-top: 0.5rem;
}

/* Tags system - Consistent with body text links */
.tags-list,
.post-tags,
.tags-cloud {
  margin: 1rem 0;
  line-height: 1.8;
}

.tags-list .tag,
.post-tags .tag,
.tags-cloud .tag {
  display: inline;
  font-style: italic;
  font-size: 1.2rem;
  color: inherit;
  margin-right: 1.2rem;
  text-underline-offset: var(--text-underline-offset);
  text-decoration-thickness: var(--text-decoration-thickness);
}

.tags-list .tag:last-child,
.post-tags .tag:last-child,
.tags-cloud .tag:last-child {
  margin-right: 0;
}

/* Tag count styling */
.tag-count {
  font-style: normal;
  font-size: 0.9em;
  opacity: 0.7;
}

/* Tag cloud specific */
.tags-cloud {
  margin: 2rem 0;
  line-height: 2.2;
}

/* Tag size classes based on count */
.tag-size-1 {
  font-size: 1.1rem;
}

.tag-size-2 {
  font-size: 1.3rem;
}

.tag-size-3 {
  font-size: 1.5rem;
}

/* Fullwidth content container - breaks out of sidenote width constraints */
.fullwidth-content {
  width: 100%;
  max-width: var(--width-fullwidth);
  margin: 1.4rem 0;
  clear: both;
}

.fullwidth-content img {
  max-width: 100%;
  height: auto;
  display: block;
  margin: 1rem auto;
}

.fullwidth-content p,
.fullwidth-content pre,
.fullwidth-content figure {
  max-width: 100%;
  width: 100%;
}

/* Table styling - Tufte CSS style */
table {
  border-collapse: collapse;
  font-family: var(--font-serif);
  font-size: var(--font-size-body);
  line-height: var(--line-height-body);
  width: 100%;
  margin: 1.4rem 0;
  border: 1px solid var(--accent);
  border-radius: 4px;
}

table caption {
  caption-side: top;
  font-family: var(--font-serif);
  font-size: var(--font-size-sidenote);
  text-align: left;
  margin: 0 1rem 0.5rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid var(--accent);
  color: var(--text-color);
}

table th {
  font-family: var(--font-serif);
  font-weight: 600;
  text-align: left;
  padding: 0.75rem 1rem;
  vertical-align: bottom;
}

table td {
  padding: 0.75rem 1rem;
  vertical-align: top;
  border-bottom: 1px solid var(--accent);
}

table tbody tr:last-child td {
  border-bottom: none;
}

table tbody tr:hover {
  background-color: var(--accent);
}

/* Numeric columns - right aligned with tabular figures */
table td.numeral,
table th.numeral {
  font-family: var(--font-serif);
  text-align: right;
}

/* Dark mode support for tables */
@media (prefers-color-scheme: dark) {
  table caption {
    color: var(--text-color-dark);
  }

  table thead {
    border-bottom-color: var(--text-color-dark);
  }

  table td {
    border-bottom-color: rgba(255, 255, 255, 0.1);
  }

  table tbody tr:hover {
    background-color: var(--accent);
  }
}
